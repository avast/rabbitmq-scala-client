apply plugin: 'com.google.protobuf'
apply plugin: 'idea'

archivesBaseName = "rabbitmq-client-core_$scalaVersion"

protobuf {
    protoc {
        artifact = "com.google.protobuf:protoc:2.6.1-build2"
    }
}

idea.module {
    testSourceDirs += file("$buildDir/generated/source/proto/test/java")
}

dockerCompose.isRequiredBy(test)

test.doFirst {
    dockerCompose.exposeAsSystemProperties(test)
}

dependencies {
    compile project(":api")

    compile "com.avast.metrics:metrics-scala_$scalaVersion:${metricsVersion}"
    compile "com.typesafe.scala-logging:scala-logging_$scalaVersion:3.9.0"

    compile "com.avast.bytes:bytes-core:${bytesVersion}"

    compile 'com.rabbitmq:amqp-client:5.1.2'
    compile 'com.typesafe:config:1.3.3'
    compile "com.iheart:ficus_$scalaVersion:1.4.3"

    compile "io.monix:monix_$scalaVersion:2.3.3"

    compile "com.avast.kluzo:kluzo-scala_$scalaVersion:3.0.1"
    compile "com.avast.continuity:continuity-monix_$scalaVersion:3.2.0"

    compile 'org.xbib:jsr-305:1.0.0'

    testCompile project(":extras")
    testCompile project(":extras-circe")
    testCompile project(":extras-cactus")

    testCompile "io.circe:circe-generic_$scalaVersion:$circeVersion"
    testCompile "io.circe:circe-generic-extras_$scalaVersion:$circeVersion"
    testCompile "com.avast.cactus:cactus-gpbv2_$scalaVersion:$cactusVersion"
    testCompile "com.avast.cactus:cactus-bytes-gpbv2_$scalaVersion:$cactusVersion"
    testCompile "com.google.protobuf:protobuf-java:2.6.1"
}